<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Insight Bl</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta property="og:type" content="website">
<meta property="og:title" content="Insight Bl">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="Insight Bl">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Insight Bl">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Insight Bl" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<meta name="generator" content="Hexo 7.0.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Insight Bl</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">领先的企业级Web报表工具</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/atom.xml" title="RSS 订阅"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="搜索"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="搜索"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-index" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/12/15/index/" class="article-date">
  <time class="dt-published" datetime="2023-12-15T05:01:21.000Z" itemprop="datePublished">2023-12-15</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2023/12/15/index/">BI报表操作手册</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="一、建表"><a href="#一、建表" class="headerlink" title="一、建表"></a>一、建表</h1><p>进入大屏驾驶舱设计平台首页，点击报表管理-&gt;excel报表-&gt;新建报表-&gt;新建空白页面-&gt;输入报表名称-&gt;选择所属项目-&gt;选择所属项目-&gt;点击确认进入编辑页面</p>
<p><img src="/../images/image1.png"></p>
<p><img src="/../images/image2.png"></p>
<h1 id="二、基础工具栏"><a href="#二、基础工具栏" class="headerlink" title="二、基础工具栏"></a>二、基础工具栏</h1><p>报表编辑页正上方有一行工具栏，由左到右依次是：撤销与重做、格式刷、字号、加粗、倾斜、删除线、下划线、字体颜色、背景颜色、单元格边框样式、合并单元格、单元格水平对齐方式、单元格垂直对齐方式、插入图表、查找和替换、单元格斜表头。</p>
<p><img src="/../images/image3.png"> </p>
<p>（注：以上工具都需要选中想要设置样式的单元格后使用，不作用于全局）</p>
<h2 id="2-1-插入图表"><a href="#2-1-插入图表" class="headerlink" title="2.1 插入图表"></a>2.1 插入图表</h2><p>点击插入图标后，在添加图标弹窗选择要添加的图表类型，图表的数据源不来源于表格内，使用方法详情参考大屏报表的图表使用。</p>
<p><img src="/../images/image4.png"></p>
<h2 id="2-2单元格斜表头"><a href="#2-2单元格斜表头" class="headerlink" title="2.2单元格斜表头"></a>2.2单元格斜表头</h2><p>选中单元格，点击一下产生一根斜线，点击多下产生多根斜线，将需要分隔的内容用“|”隔开，点击保存后，在预览页面展示效果。</p>
<p><img src="/../images/image5.png"></p>
<p><img src="/../images/image6.png"></p>
<h1 id="三、基本单元格属性"><a href="#三、基本单元格属性" class="headerlink" title="三、基本单元格属性"></a>三、基本单元格属性</h1><h2 id="3-1-概述"><a href="#3-1-概述" class="headerlink" title="3.1 概述"></a>3.1 概述</h2><p>报表设计页面右侧为基本单元格属性设置框，如下图所示：</p>
<p><img src="/../images/image7.png"></p>
<p>基本单元格设置框可填写内容会根据被选择的单元格是否为数据列格式而变化。</p>
<h2 id="3-2-坐标"><a href="#3-2-坐标" class="headerlink" title="3.2 坐标"></a>3.2 坐标</h2><p>自动回显当前选中单元格的坐标。</p>
<h2 id="3-3-聚合类型"><a href="#3-3-聚合类型" class="headerlink" title="3.3 聚合类型"></a>3.3 聚合类型</h2><p>表格报表的预览效果都是通过对基础数据进行加工而来的。制作一张报表模板，首先需准备报表所需的基础数据。不管通过对数据集数据进行哪些预处理，最终返回如下图所示的一张二维表：</p>
<p><img src="/../images/image8.png"></p>
<p>拥有了这些基础数据后，就可以对这些数据进行再加工，让其显示出所需的样式。其数据的显示方式有三种分别为：列表、分组、汇总，如下图：</p>
<p><img src="/../images/image9.png"></p>
<h3 id="3-2-1-列表"><a href="#3-2-1-列表" class="headerlink" title="3.2.1 列表"></a>3.2.1 列表</h3><p><img src="/../images/image10.png"></p>
<p>如图，制作的报表展示出来的数据与数据集数据完全相同，即数据集中的每条记录无论是否重复都原封不动的展示出来，是清单式明细列表。</p>
<p><img src="/../images/image11.png"></p>
<p>单元格默认为列表，设置方式如上图，选中单元格，选择单元格属性聚合类型为“列表”，设为列表的单元格用英文“Select”表示。</p>
<h3 id="3-2-2-分组"><a href="#3-2-2-分组" class="headerlink" title="3.2.2 分组"></a>3.2.2 分组</h3><p>­ <img src="/../images/image12.png"></p>
<p>如上图所示，将数据列中相同项合并单元格为一组显示的方式为分组。</p>
<p><img src="/../images/image13.png"></p>
<p>设置方式如上图，选中单元格，选择单元格属性聚合类型为“分组”，设为分组的单元格用英文“Group”表示。</p>
<h3 id="3-3-3-无"><a href="#3-3-3-无" class="headerlink" title="3.3.3 无"></a>3.3.3 无</h3><h2 id="3-4-扩展方向"><a href="#3-4-扩展方向" class="headerlink" title="3.4 扩展方向 "></a>3.4 扩展方向 </h2><p>扩展是有方向的，可以选择依次从上至下的显示，即纵向扩展（行方向的扩展）；或者是依次从左到右的显示，即横向扩展（列方向的扩展）；也可以选择不扩展，在一个单元格中显示。</p>
<h3 id="3-4-1-无"><a href="#3-4-1-无" class="headerlink" title="3.4.1 无"></a>3.4.1 无</h3><p>即单元格中字段不扩展，所有数据在一个单元格中展示</p>
<h3 id="3-4-2-横向"><a href="#3-4-2-横向" class="headerlink" title="3.4.2 横向"></a>3.4.2 横向</h3><p>横向扩展，即单元格中字段的数据向右平铺，在不同单元格中展示。</p>
<p><img src="/../images/image14.png"></p>
<p>设置方式如上图，选中单元格，选择单元格属性扩展方向为横向。</p>
<p>设置成功保存后预览如下图所示，字段数据向右平铺：</p>
<p><img src="/../images/image15.png"></p>
<h3 id="3-4-3-纵向"><a href="#3-4-3-纵向" class="headerlink" title="3.4.3 纵向"></a>3.4.3 纵向</h3><p>纵向扩展，即单元格中字段的数据向下平铺，在不同单元格中展示。</p>
<p><img src="/../images/image16.png"></p>
<p>设置方式如上图，选中单元格，选择单元格属性扩展方向为纵向。</p>
<p>设置成功保存后预览如下图所示，字段数据向下平铺：</p>
<p><img src="/../images/image17.png"></p>
<h2 id="3-5-主格关系"><a href="#3-5-主格关系" class="headerlink" title="3.5 主格关系"></a>3.5 主格关系</h2><p>主格关系用于设置绑定数据的单元格跟随扩展以及依赖关系，数据列单元格都要至少设置一个主格，以保证返回数据的关联性。</p>
<p>系统支持两种类型的主格设置：</p>
<p>左主格：单元格之间存在纵向扩展的关系时，设置左主格。</p>
<p>上主格：单元格之间存在横向扩展的关系时，设置上主格。</p>
<p><img src="/../images/image18.png"></p>
<p><img src="/../images/image19.png"></p>
<p>将字段拖拽至单元格中时，该单元格会默认将其相邻上方横向扩展的单元格或者左侧纵向扩展的单元格当做上主格或者左主格，主格输入框默认输入。也可以自行设置主格，设置方式如上图，选中单元格，如该单元格与其左侧或上侧相邻单元格具有扩展关系，在左主格&#x2F;上主格输入框填写左侧或上侧相邻单元格坐标。</p>
<p>注：必须是相邻的同行或同列单元格。</p>
<p>报表效果如下图所示：</p>
<p><img src="/../images/image20.png"></p>
<h2 id="3-5-公式"><a href="#3-5-公式" class="headerlink" title="3.5 公式"></a>3.5 公式</h2><p>公示用于对数据库返回的数据进行计算，有四种，求和，最小值，最大值，平均值，一般用于实现小计和总计等功能。</p>
<p>选中要插入公式的单元格，在公示选择框选择要插入的公式。在公式的括号中输入单元格范围。</p>
<p><img src="/../images/image21.png"></p>
<p>公式预览效果如下：</p>
<p><img src="/../images/image22.png"></p>
<h2 id="3-6-格式"><a href="#3-6-格式" class="headerlink" title="3.6 格式"></a>3.6 格式</h2><p>设置数据库返回数据的格式，只有数据列单元格能选择格式</p>
<p>选中要设置格式的绑定数据的单元格，选择格式，在下面的选择框中选择具体格式</p>
<p><img src="/../images/image23.png"></p>
<p>公式预览效果如下图：</p>
<p><img src="/../images/image24.png"></p>
<h2 id="3-7-过滤条件"><a href="#3-7-过滤条件" class="headerlink" title="3.7 过滤条件"></a>3.7 过滤条件</h2><p>用于多源数据集绑定操作</p>
<p>选中要绑定多元数据集的单元格，点击编辑-&gt;点击添加-&gt;输入操作符、数据集以及值-&gt;点击确认。</p>
<p><img src="/../images/image25.png"></p>
<h1 id="四、行式报表"><a href="#四、行式报表" class="headerlink" title="四、行式报表"></a>四、行式报表</h1><p>行式报表即清单式明细表，是最常见也是最简单的报表样式。</p>
<p>行式报表对数据进行纵向扩展，将数据展示为一个列表式的表格，如下图所示：</p>
<p><img src="/../images/image26.png"></p>
<h2 id="4-1-创建报表"><a href="#4-1-创建报表" class="headerlink" title="4.1 创建报表"></a>4.1 创建报表</h2><p>表格报表模块，点击【新建excel表格】，</p>
<p><img src="/../images/image27.png"></p>
<p>表格创建页可以选择【新建空白页面】或者选择模板进行创建。</p>
<p><img src="/../images/image28.png"></p>
<p>选择好模板或空白页后，点击【确认新建】，弹出excel报表属性弹窗：</p>
<p>报表名称：必填，手动输入，字数限制20字。</p>
<p>所属项目：下拉选择，必选，选择所创建报表要绑定的项目。</p>
<p>报表封面：非必填，可上传报表展示封面。</p>
<p><img src="/../images/image29.png"></p>
<p>点击确认跳转报表设计页。</p>
<h2 id="4-2-报表设计"><a href="#4-2-报表设计" class="headerlink" title="4.2 报表设计"></a>4.2 报表设计</h2><p>（1）<br>单元格写入表格表头信息，将数据集中的相关数据列按照标题字段依次拖入到<br>A2~F2 单元格，将字体居中，添加框线，选择单元格颜色。</p>
<p><img src="/../images/image30.png"></p>
<p>（2）选中 D2 单元格，右边基本面板设置单元格格式为「日期型 &gt;<br>yyyy-MM」，将日期设置为「年月」的格式。如下图所示：</p>
<p><img src="/../images/image31.png"></p>
<p>（3）选中 F2 单元格，右边基本面板设置单元格格式为「数值 &gt;<br>#,##0.00」，保留数值小数点后两位。如下图所示：</p>
<p><img src="/../images/image32.png"></p>
<p>保存报表，点击【预览】按钮，预览效果如下图：</p>
<p><img src="/../images/image33.png"></p>
<p>可依照自己的需求对单元格进行样式和属性的修改。</p>
<h2 id="4-3-行式横向报表"><a href="#4-3-行式横向报表" class="headerlink" title="4.3 行式横向报表"></a>4.3 行式横向报表</h2><p>行式报表还存在横向的行式报表，如下图所示：</p>
<p><img src="/../images/image34.png"></p>
<p>在A1~A4写入表格表头信息，将数据集中的相关数据列按照标题字段依次拖入到<br>B1~B4 单元格，按照需求设置单元格样式和属性。</p>
<p>需要注意的是，数据列拖入单元格时扩展方向默认选择纵向，行式横向报表需要手动修改单元格扩展方向为横向。</p>
<p>预览效果如下图：</p>
<p><img src="/../images/image35.png"></p>
<h1 id="五、分组报表"><a href="#五、分组报表" class="headerlink" title="五、分组报表"></a>五、分组报表</h1><p>分组报表指将一个或多个数据绑定分组，将行式报表汇总字段展示，如下图所示：</p>
<p><img src="/../images/image36.png"></p>
<h2 id="5-1-报表设计"><a href="#5-1-报表设计" class="headerlink" title="5.1 报表设计"></a>5.1 报表设计</h2><p>（1）A1~F1单元格写入表格表头信息，将数据集里的相关数据列按照标题字段依次拖入到A2~F2 单元格，将字体居中，添加框线，选择单元格颜色。</p>
<p><img src="/../images/image37.png"></p>
<p>（2）选中A2单元格,右边基本面板在聚合类型下拉菜单选择【分组】，扩展方向默认选择【纵向扩展】，如下图所示：</p>
<p><img src="/../images/image38.png"></p>
<p>（3）选中B2单元格,右边基本面板在聚合类型下拉菜单选择【分组】，扩展方向默认选择【纵向扩展】，左主格默认带入【A2】，如下图所示：</p>
<p><img src="/../images/image39.png"></p>
<p>（4）依次选中C2、D2单元格，聚合类型、扩展方向默认选择为【列表】和【纵向】，默认带入左主格，如下图所示：</p>
<p><img src="/../images/image40.png"></p>
<p>保存报表，点击【预览】，预览效果如下图：</p>
<p><img src="/../images/image41.png"></p>
<h2 id="5-2-横向分组报表"><a href="#5-2-横向分组报表" class="headerlink" title="5.2 横向分组报表"></a>5.2 横向分组报表</h2><p>分组报表还存在横向的分组报表，如下图所示：</p>
<p><img src="/../images/image42.png"></p>
<p>在A1~A2写入表格表头信息，将数据集中的相关数据列按照标题字段依次拖入到<br>B1~B2<br>单元格，按照需求设置单元格样式，选择B1的聚合类型为分组，填写B2的上主格为B1。</p>
<p>需要注意的是，数据列拖入单元格时扩展方向默认选择纵向，分组横向报表需要手动修改单元格扩展方向为横向。</p>
<p>预览效果如下图：</p>
<p><img src="/../images/image43.png"></p>
<h1 id="六、交叉报表"><a href="#六、交叉报表" class="headerlink" title="六、交叉报表"></a>六、交叉报表</h1><p>交叉报表是常见的基本报表类型，交叉报表同时包含横向扩展交叉报表和纵向扩展交叉报表，交叉报表的特点是表头是由上表头和左表头组成，如下图所示：</p>
<p><img src="/../images/image44.png"></p>
<h2 id="6-1-报表设计"><a href="#6-1-报表设计" class="headerlink" title="6.1 报表设计"></a>6.1 报表设计</h2><p>（1）按照下面表格中的说明设计表格样式：</p>
<p>  单元格   操作</p>
<hr>
<p>  A1~C2   合并A1~C2单元格，选中单元格，点击【斜线】按钮。在单元格内写入：区域|省份|城市|产品|日期。（报表斜表头需要多次点击斜线按钮。点击一下产生一根斜线，点击多下产生多根斜线，将需要分隔的内容用“|”隔开，点击保存后，在预览页面展示效果。）<br>  E1~E2   合并单元格，写入字段【销量总计】<br>  A1~E2   修改单元格填充色</p>
<p>效果如下图：</p>
<p>（2）按照下面表格中的说明将数据集中数据列拖入到对应单元格中，并对单元格属性进行设置</p>
<p>  单元格   操作</p>
<hr>
<p>  A3       拖入sales数据集【region】字段，单元格默认【纵向扩展】，聚合类型选择【分组】<br>  B3       拖入sales数据集【province】字段，单元格默认【纵向扩展】，聚合类型选择【分组】，默认左主格为A3<br>  C3       拖入sales数据集【city】字段，单元格默认【纵向扩展】，聚合类型选择【分组】，默认左主格为B3<br>  D3       拖入sales数据集【sales_volume】字段，由于C3、D2能确定唯一的销量值，故D3无需扩展方向，单元格选择扩展方向【无】，聚合类型默认【列表】，默认左主格为C3，填写上主格为D2<br>  D1       拖入sales数据集【month】字段，单元格选择扩展方向为【横向扩展】，聚合类型选择【分组】<br>  D2       拖入sales数据集【product】字段，单元格选择扩展方向为【横向扩展】，聚合类型选择【分组】，默认上主格为D1<br>  E3       对D3单元格求和，选择求和公式sum（D3）</p>
<p>选中A1~E3，将所有字体居中，修改A3~E3单元格的填充色，效果如下图：</p>
<p><img src="/../images/image45.png"></p>
<p>预览效果如下图：</p>
<p><img src="/../images/image46.png"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2023/12/15/index/" data-id="clq5wwwlb000028v7ef61g4n0" data-title="BI报表操作手册" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  


</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/12/">十二月 2023</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2023/12/15/index/">BI报表操作手册</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2023 Insight Bl<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.6.4.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>